<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>clinamen2.utils package &mdash; Clinamen2 2023.05.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="clinamen2.runner package" href="clinamen2.runner.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Clinamen2
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="example_tutorials.html">Example tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">clinamen2</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="clinamen2.html">clinamen2 package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="clinamen2.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="clinamen2.cmaes.html">clinamen2.cmaes package</a></li>
<li class="toctree-l4"><a class="reference internal" href="clinamen2.runner.html">clinamen2.runner package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">clinamen2.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="clinamen2.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="clinamen2.html#module-clinamen2.test_functions">clinamen2.test_functions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="clinamen2.html#module-clinamen2">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Clinamen2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">clinamen2</a></li>
          <li class="breadcrumb-item"><a href="clinamen2.html">clinamen2 package</a></li>
      <li class="breadcrumb-item active">clinamen2.utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/clinamen2.utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="clinamen2-utils-package">
<h1>clinamen2.utils package<a class="headerlink" href="#clinamen2-utils-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-clinamen2.utils.bipop_restart">
<span id="clinamen2-utils-bipop-restart-module"></span><h2>clinamen2.utils.bipop_restart module<a class="headerlink" href="#module-clinamen2.utils.bipop_restart" title="Permalink to this heading"></a></h2>
<p>Dataclass and functions for BIPOP-CMA-ES.</p>
<p>References:</p>
<p>[1] N. Hansen. Benchmarking a BI-population CMA-ES on the BBOB-2009
function testbed. In Workshop Proceedings of the GECCO Genetic and
Evolutionary Computation Conference. ACM, 2009.</p>
<p>[2] I. Loshchilov. CMA-ES with Restarts for Solving CEC 2013 Benchmark
Problems. IEEE Congress on Evolutionary Computation, Jun 2013, Cancun,
Mexico. hal-00823880.</p>
<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.BIPOP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.bipop_restart.</span></span><span class="sig-name descname"><span class="pre">BIPOP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_pop_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_step_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">large_restart_counter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latest_large_pop_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_counter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/bipop_restart.html#BIPOP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.bipop_restart.BIPOP" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Dataclass representing the current state of a BIPOP run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>default_pop_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Default population size calculated by the CMA-ES.</p></li>
<li><p><strong>default_step_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Default global variance of the Gaussian.</p></li>
<li><p><strong>random_state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Dictionary representing the state of the random
generator (numpy.random.default_rng()).</p></li>
<li><p><strong>large_restart_counter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of restarts with large population.</p></li>
<li><p><strong>latest_large_pop_size</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Latest used large population size.</p></li>
<li><p><strong>eval_counter</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Function evaluations for large and small restarts.
Saved in a Tuple[large, small].</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.BIPOP.default_pop_size">
<span class="sig-name descname"><span class="pre">default_pop_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#clinamen2.utils.bipop_restart.BIPOP.default_pop_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.BIPOP.default_step_size">
<span class="sig-name descname"><span class="pre">default_step_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></em><a class="headerlink" href="#clinamen2.utils.bipop_restart.BIPOP.default_step_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.BIPOP.eval_counter">
<span class="sig-name descname"><span class="pre">eval_counter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code><span class="pre">[</span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">,</span> <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code><span class="pre">]</span></em><a class="headerlink" href="#clinamen2.utils.bipop_restart.BIPOP.eval_counter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.BIPOP.large_restart_counter">
<span class="sig-name descname"><span class="pre">large_restart_counter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#clinamen2.utils.bipop_restart.BIPOP.large_restart_counter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.BIPOP.latest_large_pop_size">
<span class="sig-name descname"><span class="pre">latest_large_pop_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></em><a class="headerlink" href="#clinamen2.utils.bipop_restart.BIPOP.latest_large_pop_size" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.BIPOP.random_state">
<span class="sig-name descname"><span class="pre">random_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></em><a class="headerlink" href="#clinamen2.utils.bipop_restart.BIPOP.random_state" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.bipop_init">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.bipop_restart.</span></span><span class="sig-name descname"><span class="pre">bipop_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_pop_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_step_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/bipop_restart.html#bipop_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.bipop_restart.bipop_init" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a BIPOP object.</p>
<p>The arguments are ‘default’ with respect to the BIPOP algorithm, not
necessarily the CMA-ES default values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>default_pop_size</strong> – Default population size to start with.</p></li>
<li><p><strong>default_step_size</strong> – Default step size to start with.</p></li>
<li><p><strong>random_state</strong> – State of a numpy random number generator.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#clinamen2.utils.bipop_restart.BIPOP" title="clinamen2.utils.bipop_restart.BIPOP"><code class="xref py py-class docutils literal notranslate"><span class="pre">BIPOP</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Initial state of the BIPOP.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.bipop_next_restart">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.bipop_restart.</span></span><span class="sig-name descname"><span class="pre">bipop_next_restart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bipop</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/bipop_restart.html#bipop_next_restart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.bipop_restart.bipop_next_restart" title="Permalink to this definition"></a></dt>
<dd><p>Calculate pop_size, step_size for next restart.</p>
<p>Also returns an updated BIPOP. The first restart is always a large
restart.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BIPOP</strong> – Input state of the BIPOP.</p></li>
<li><p><strong>bipop</strong> (<a class="reference internal" href="#clinamen2.utils.bipop_restart.BIPOP" title="clinamen2.utils.bipop_restart.BIPOP"><em>BIPOP</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <a class="reference internal" href="#clinamen2.utils.bipop_restart.BIPOP" title="clinamen2.utils.bipop_restart.BIPOP"><code class="xref py py-class docutils literal notranslate"><span class="pre">BIPOP</span></code></a>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple containing</p>
<blockquote>
<div><ul class="simple">
<li><p>Population size for next restart.</p></li>
<li><p>Step size for next restart.</p></li>
<li><p>New state of the BIPOP.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.bipop_restart.bipop_update">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.bipop_restart.</span></span><span class="sig-name descname"><span class="pre">bipop_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bipop</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_evals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/bipop_restart.html#bipop_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.bipop_restart.bipop_update" title="Permalink to this definition"></a></dt>
<dd><p>Returns a new BIPOP with updated eval_counter.</p>
<p>The lower counter will be updated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bipop</strong> (<a class="reference internal" href="#clinamen2.utils.bipop_restart.BIPOP" title="clinamen2.utils.bipop_restart.BIPOP"><code class="xref py py-class docutils literal notranslate"><span class="pre">BIPOP</span></code></a>) – Input state of the BIPOP.</p></li>
<li><p><strong>new_evals</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Evaluation count performed since input state.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#clinamen2.utils.bipop_restart.BIPOP" title="clinamen2.utils.bipop_restart.BIPOP"><code class="xref py py-class docutils literal notranslate"><span class="pre">BIPOP</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>New state of the BIPOP.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-clinamen2.utils.file_handling">
<span id="clinamen2-utils-file-handling-module"></span><h2>clinamen2.utils.file_handling module<a class="headerlink" href="#module-clinamen2.utils.file_handling" title="Permalink to this heading"></a></h2>
<p>Read and write CMA-ES results.</p>
<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.CMAFileHandler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.file_handling.</span></span><span class="sig-name descname"><span class="pre">CMAFileHandler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">PosixPath('/home/ralf/Documents/PhD/code/clinamen/docs')</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#CMAFileHandler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.CMAFileHandler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Handle input and output files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Label of the evolution run.</p></li>
<li><p><strong>target_dir</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – Full path to target directory. Default is the current
working directory.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.CMAFileHandler.get_evolution_filename">
<span class="sig-name descname"><span class="pre">get_evolution_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#CMAFileHandler.get_evolution_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.CMAFileHandler.get_evolution_filename" title="Permalink to this definition"></a></dt>
<dd><p>Return a pathlib.Path object representing the evolution file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Label of the evolution run.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.CMAFileHandler.get_generation_filename">
<span class="sig-name descname"><span class="pre">get_generation_filename</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#CMAFileHandler.get_generation_filename"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.CMAFileHandler.get_generation_filename" title="Permalink to this definition"></a></dt>
<dd><p>Return a pathlib.Path object representing the generation file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>generation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Generation index.</p></li>
<li><p><strong>label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Label of the evolution run.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.CMAFileHandler.load_evolution">
<span class="sig-name descname"><span class="pre">load_evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'json'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#CMAFileHandler.load_evolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.CMAFileHandler.load_evolution" title="Permalink to this definition"></a></dt>
<dd><p>Function that loads an evolution from file.</p>
<dl>
<dt>Objects loaded:</dt><dd><div class="line-block">
<div class="line">‘initial_parameters’: AlgorithmParameters</div>
<div class="line">‘initial_state’: AlgorithmState</div>
<div class="line">‘termination_criterion’: Criterion</div>
<div class="line">any additional compatible information</div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – String to be added to filename.</p></li>
<li><p><strong>file_format</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Indicate the file format used for serialization.
The options are ‘json’ and ‘dill’. Default is ‘json’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.params_and_state.AlgorithmParameters" title="clinamen2.cmaes.params_and_state.AlgorithmParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmParameters</span></code></a>, <a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.params_and_state.AlgorithmState" title="clinamen2.cmaes.params_and_state.AlgorithmState"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmState</span></code></a>, <a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.termination_criterion.Criterion" title="clinamen2.cmaes.termination_criterion.Criterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">Criterion</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple containing</p>
<blockquote>
<div><ul class="simple">
<li><p>AlorithmParameters object</p></li>
<li><p>AlgorithmState object</p></li>
<li><p>Criterion object</p></li>
<li><p>Dictionary containing additional objects if present.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.CMAFileHandler.load_generation">
<span class="sig-name descname"><span class="pre">load_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_legacy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'json'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#CMAFileHandler.load_generation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.CMAFileHandler.load_generation" title="Permalink to this definition"></a></dt>
<dd><p>Function that loads a generation from file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>generation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – ID of generation to be loaded.</p></li>
<li><p><strong>label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – String to be added to filename.</p></li>
<li><p><strong>allow_legacy</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, older results containing ‘fitness’</p></li>
<li><p><strong>True.</strong> (<em>instead</em><em> of </em><em>'loss' can be loaded. Default is</em>) – </p></li>
<li><p><strong>file_format</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Indicate the file format used for serialization.
The options are ‘json’ and ‘dill’. Default is ‘json’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.params_and_state.AlgorithmState" title="clinamen2.cmaes.params_and_state.AlgorithmState"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmState</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple containing</p>
<blockquote>
<div><ul class="simple">
<li><p>AlgorithmState object</p></li>
<li><p>Array of population</p></li>
<li><p>Array of loss values</p></li>
<li><p>NamedTuple of termination state</p></li>
<li><p>Dictionary containing additional objects if present.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.CMAFileHandler.save_evolution">
<span class="sig-name descname"><span class="pre">save_evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">termination_criterion=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format='json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_encoder=&lt;class</span> <span class="pre">'clinamen2.utils.file_handling.JSONEncoder'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#CMAFileHandler.save_evolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.CMAFileHandler.save_evolution" title="Permalink to this definition"></a></dt>
<dd><p>Function that writes the initial evolution to file.</p>
<p>Accepts any data that is serializable using dill. It might be
necessary to use a different JSONEncoder. If ‘additional’ contains
dataclasses, use <cite>dataclasses.asdict()</cite> and take care to manually
re-cast after loading.</p>
<dl>
<dt>Serialized data contains:</dt><dd><div class="line-block">
<div class="line">‘initial_parameters’: AlgorithmParameters</div>
<div class="line">‘initial_state’: AlgorithmState</div>
<div class="line">‘termination_criterion’: Criterion (optional)</div>
<div class="line">any additional compatible information (dill-only)</div>
</div>
</dd>
<dt>Filenames:</dt><dd><div class="line-block">
<div class="line"><cite>evolution.json</cite></div>
<div class="line"><cite>evolution_ + label + .json</cite></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initial_parameters</strong> (<a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.params_and_state.AlgorithmParameters" title="clinamen2.cmaes.params_and_state.AlgorithmParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmParameters</span></code></a>) – The initial parameters to start the evolution.</p></li>
<li><p><strong>initial_state</strong> (<a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.params_and_state.AlgorithmState" title="clinamen2.cmaes.params_and_state.AlgorithmState"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmState</span></code></a>) – The initial state to start the evolution.</p></li>
<li><p><strong>termination_criterion</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.termination_criterion.Criterion" title="clinamen2.cmaes.termination_criterion.Criterion"><code class="xref py py-class docutils literal notranslate"><span class="pre">Criterion</span></code></a>]) – The termination criterion set up for the
evolution. Can be a combinated criterion.</p></li>
<li><p><strong>label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – String to be added to filename.</p></li>
<li><p><strong>additional</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]) – Additional information to be saved with the
initial evolution properties.</p></li>
<li><p><strong>file_format</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Indicate the file format to be used for serialization.
The options are ‘json’ and ‘dill’. Default is ‘json’.</p></li>
<li><p><strong>json_encoder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">JSONEncoder</span></code>) – If default encoder file_handling.JSONEncoder does not
offer the required functionality, e.g., JAX datatypes.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Name of generated file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.CMAFileHandler.save_generation">
<span class="sig-name descname"><span class="pre">save_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">population</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">termination_state=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_format='json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json_encoder=&lt;class</span> <span class="pre">'clinamen2.utils.file_handling.JSONEncoder'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#CMAFileHandler.save_generation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.CMAFileHandler.save_generation" title="Permalink to this definition"></a></dt>
<dd><p>Function that writes a generation to file.</p>
<p>Accepts any data that is serializable using dill.</p>
<dl>
<dt>Serialized data contains:</dt><dd><div class="line-block">
<div class="line">‘current_state’: AlgorithmState</div>
<div class="line">‘population’: numpy.ArrayLike</div>
<div class="line">‘loss’: numpy.ArrayLike</div>
<div class="line">‘termination_state’: NamedTuple</div>
<div class="line">any additional compatible information in a dictionary</div>
</div>
</dd>
<dt>Filenames:</dt><dd><p>‘generation’ + str(number) + ‘.json’
‘generation’ + label + ‘_’ + str(number) +’.json’</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current_state</strong> (<a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.params_and_state.AlgorithmState" title="clinamen2.cmaes.params_and_state.AlgorithmState"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmState</span></code></a>) – The current state of the evolution.</p></li>
<li><p><strong>population</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>) – The population of individuals of the generation.</p></li>
<li><p><strong>loss</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>) – Loss of each individual within the population.</p></li>
<li><p><strong>termination_state</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code>]) – State of termination criterion.</p></li>
<li><p><strong>label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – String to be added to filename.</p></li>
<li><p><strong>additional</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]) – Additional information to be saved with the initial
evolution properties.</p></li>
<li><p><strong>file_format</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Indicate the file format to be used for serialization.
The options are ‘json’ and ‘dill’. Default is ‘json’.</p></li>
<li><p><strong>json_encoder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">JSONEncoder</span></code>) – If default encoder file_handling.JSONEncoder does not
offer the required functionality, e.g., JAX datatypes.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Name of generated file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.CMAFileHandler.update_evolution">
<span class="sig-name descname"><span class="pre">update_evolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#CMAFileHandler.update_evolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.CMAFileHandler.update_evolution" title="Permalink to this definition"></a></dt>
<dd><p>Function that calls save_evolution(file_format=’json’).</p>
<p>Accepts all data that is serializable using json.
Values for keys that are already present in the existing additional
information will be replaced.</p>
<dl>
<dt>Filenames:</dt><dd><div class="line-block">
<div class="line"><cite>evolution.json</cite></div>
<div class="line"><cite>evolution_ + label + .json</cite></div>
</div>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Label of the evolution run.</p></li>
<li><p><strong>additional</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]) – Additional information to be saved with the
evolution properties.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Name of evolution file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.JSONDecoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.file_handling.</span></span><span class="sig-name descname"><span class="pre">JSONDecoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#JSONDecoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.JSONDecoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">JSONDecoder</span></code></p>
<p>Class that extends the JSONDecoder to handle different data types.</p>
<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.JSONDecoder.object_hook">
<span class="sig-name descname"><span class="pre">object_hook</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#JSONDecoder.object_hook"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.JSONDecoder.object_hook" title="Permalink to this definition"></a></dt>
<dd><p>Reencode numpy arrays from dictionary.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.JSONEncoder">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.file_handling.</span></span><span class="sig-name descname"><span class="pre">JSONEncoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipkeys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_circular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#JSONEncoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.JSONEncoder" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">JSONEncoder</span></code></p>
<p>Class that extends JSONEncoder to handle different data types.</p>
<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.file_handling.JSONEncoder.default">
<span class="sig-name descname"><span class="pre">default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/file_handling.html#JSONEncoder.default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.file_handling.JSONEncoder.default" title="Permalink to this definition"></a></dt>
<dd><p>Return a json-izable version of o or delegate on the base class.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-clinamen2.utils.jax_data">
<span id="clinamen2-utils-jax-data-module"></span><h2>clinamen2.utils.jax_data module<a class="headerlink" href="#module-clinamen2.utils.jax_data" title="Permalink to this heading"></a></h2>
<p>JSONEncoder that handles DeviceArrays.</p>
<p>Removed from file_handling to avoid jnp dependency.</p>
<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.jax_data.JSONEncoderwithJNP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.jax_data.</span></span><span class="sig-name descname"><span class="pre">JSONEncoderwithJNP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipkeys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_ascii</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_circular</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_nan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/jax_data.html#JSONEncoderwithJNP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.jax_data.JSONEncoderwithJNP" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">JSONEncoder</span></code></p>
<p>Class that extends JSONEncoder to handle different data types.</p>
<p>Separate version that encodes JNP arrays to numpy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.jax_data.JSONEncoderwithJNP.default">
<span class="sig-name descname"><span class="pre">default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/jax_data.html#JSONEncoderwithJNP.default"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.jax_data.JSONEncoderwithJNP.default" title="Permalink to this definition"></a></dt>
<dd><p>Return a json-izable version of o or delegate on the base class.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-clinamen2.utils.lennard_jones">
<span id="clinamen2-utils-lennard-jones-module"></span><h2>clinamen2.utils.lennard_jones module<a class="headerlink" href="#module-clinamen2.utils.lennard_jones" title="Permalink to this heading"></a></h2>
<p>Implementation of the Lennard Jones potential and related functions.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="clinamen2.utils.lennard_jones.PositionException">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.lennard_jones.</span></span><span class="sig-name descname"><span class="pre">PositionException</span></span><a class="reference internal" href="../_modules/clinamen2/utils/lennard_jones.html#PositionException"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.lennard_jones.PositionException" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception to be raised for exceeding position threshold.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.lennard_jones.create_evaluate_lj_potential">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.lennard_jones.</span></span><span class="sig-name descname"><span class="pre">create_evaluate_lj_potential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">38</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wales_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_eval_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/lennard_jones.html#create_evaluate_lj_potential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.lennard_jones.create_evaluate_lj_potential" title="Permalink to this definition"></a></dt>
<dd><p>Create an LJ evaluation function from a Cambridge database entry</p>
<p>Load the coordinates of the ground state of an n- atom LJ cluster
from an entry in</p>
<p><a class="reference external" href="http://doye.chem.ox.ac.uk/jon/structures/LJ.html">http://doye.chem.ox.ac.uk/jon/structures/LJ.html</a></p>
<p>and return the corresponding LennardJones object and an eval function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of atoms in the cluster.</p></li>
<li><p><strong>identifier</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Additional identifier of a specific configuration.
For example “i” for “38i”. Default is None.</p></li>
<li><p><strong>wales_path</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]) – Path to the Wales potential data.</p></li>
<li><p><strong>n_eval_batch</strong> – Batchsize to be vmapped.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt>tuple</dt><dd><ul class="simple">
<li><p>Coordinates of specified Cluster</p></li>
<li><p>Evaluation function</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If there is a problem with the argument.</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1] The Cambridge Cluster Database, D. J. Wales, J. P. K. Doye,
A. Dullweber, M. P. Hodges, F. Y. Naumkin F. Calvo, J. Hernández-Rojas
and T. F. Middleton, URL <a class="reference external" href="http://www-wales.ch.cam.ac.uk/CCD.html">http://www-wales.ch.cam.ac.uk/CCD.html</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.lennard_jones.create_position_filter">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.lennard_jones.</span></span><span class="sig-name descname"><span class="pre">create_position_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception=&lt;class</span> <span class="pre">'BaseException'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/lennard_jones.html#create_position_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.lennard_jones.create_position_filter" title="Permalink to this definition"></a></dt>
<dd><p>Create function to filter configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position_bounds</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>) – Positions components that may not be crossed.
Shape is (3, 2): 3 components, lower and upper bound for each.</p></li>
<li><p><strong>exception</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code>) – Exception identifying an issue with the calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.lennard_jones.get_max_span_from_lj_cluster">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.lennard_jones.</span></span><span class="sig-name descname"><span class="pre">get_max_span_from_lj_cluster</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lj_cluster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/lennard_jones.html#get_max_span_from_lj_cluster"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.lennard_jones.get_max_span_from_lj_cluster" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate LJ cluster positions and return largest span.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lj_cluster</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>) – Positions of the LJ spheres.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.lennard_jones.lj_argparse">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.lennard_jones.</span></span><span class="sig-name descname"><span class="pre">lj_argparse</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/lennard_jones.html#lj_argparse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.lennard_jones.lj_argparse" title="Permalink to this definition"></a></dt>
<dd><p>Argument parser for LJ evolution scripts.</p>
<dl class="simple">
<dt>Returns</dt><dd><p>Parsed arguments</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-clinamen2.utils.neuralil_evaluation">
<span id="clinamen2-utils-neuralil-evaluation-module"></span><h2>clinamen2.utils.neuralil_evaluation module<a class="headerlink" href="#module-clinamen2.utils.neuralil_evaluation" title="Permalink to this heading"></a></h2>
<p>Functions to evaluate NeuralIL models (including ensembles).</p>
<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.neuralil_evaluation.</span></span><span class="sig-name descname"><span class="pre">NeuralILInputPipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">neuralil_pipeline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clinamen_pipeline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/neuralil_evaluation.html#NeuralILInputPipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Combined pipelines for input transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neuralil_pipeline</strong> (<em>Callable</em>) – Function pipeline performing NeuralIL specific data
transformation.</p></li>
<li><p><strong>clinamen_pipeline</strong> (<em>Callable</em>) – Function pipeline performing Clinamen2 specific
data transformation.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline.clinamen_pipeline">
<span class="sig-name descname"><span class="pre">clinamen_pipeline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline.clinamen_pipeline" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline.neuralil_pipeline">
<span class="sig-name descname"><span class="pre">neuralil_pipeline</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline.neuralil_pipeline" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.create_batch_input_pipeline">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.neuralil_evaluation.</span></span><span class="sig-name descname"><span class="pre">create_batch_input_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/neuralil_evaluation.html#create_batch_input_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.create_batch_input_pipeline" title="Permalink to this definition"></a></dt>
<dd><p>Create combined pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pipeline</strong> (<a class="reference internal" href="#clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline" title="clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralILInputPipeline</span></code></a>) – Function pipeline for batched input transformation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.create_input_pipeline">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.neuralil_evaluation.</span></span><span class="sig-name descname"><span class="pre">create_input_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/neuralil_evaluation.html#create_input_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.create_input_pipeline" title="Permalink to this definition"></a></dt>
<dd><p>Create combined pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pipeline</strong> (<a class="reference internal" href="#clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline" title="clinamen2.utils.neuralil_evaluation.NeuralILInputPipeline"><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralILInputPipeline</span></code></a>) – Function pipeline for input transformation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.create_neuralil_calc_energy">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.neuralil_evaluation.</span></span><span class="sig-name descname"><span class="pre">create_neuralil_calc_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamics_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/neuralil_evaluation.html#create_neuralil_calc_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.create_neuralil_calc_energy" title="Permalink to this definition"></a></dt>
<dd><p>Closure that returns wrappers for jitted evaluation functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamics_model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – NeuralIL model or ensemble model.</p></li>
<li><p><strong>model_info</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralILModelInfo</span></code>) – Model info containing parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple containing</p>
<blockquote>
<div><ul class="simple">
<li><p>Closure for evaluation of single structure.</p></li>
<li><p>Closure for vmapped evaluation.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.create_neuralil_calc_energy_and_forces">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.neuralil_evaluation.</span></span><span class="sig-name descname"><span class="pre">create_neuralil_calc_energy_and_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamics_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/neuralil_evaluation.html#create_neuralil_calc_energy_and_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.create_neuralil_calc_energy_and_forces" title="Permalink to this definition"></a></dt>
<dd><p>Closure that returns wrappers for jitted evaluation functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamics_model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – NeuralIL model or ensemble model.</p></li>
<li><p><strong>model_info</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralILModelInfo</span></code>) – Model info containing parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple containing</p>
<blockquote>
<div><ul class="simple">
<li><p>Closure for evaluation of single structure.</p></li>
<li><p>Closure for vmapped evaluation.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.create_neuralil_calc_energy_and_forces_uncertainty">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.neuralil_evaluation.</span></span><span class="sig-name descname"><span class="pre">create_neuralil_calc_energy_and_forces_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dynamics_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/neuralil_evaluation.html#create_neuralil_calc_energy_and_forces_uncertainty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.create_neuralil_calc_energy_and_forces_uncertainty" title="Permalink to this definition"></a></dt>
<dd><p>Closure that returns wrappers for jitted evaluation functions.</p>
<blockquote>
<div><p>Also returns uncertainty calculated from forces.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dynamics_model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code>) – NeuralIL model or ensemble model.</p></li>
<li><p><strong>model_info</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralILModelInfo</span></code>) – Model info containing parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code>]</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple containing</p>
<blockquote>
<div><ul class="simple">
<li><p>Closure for evaluation of single structure.</p></li>
<li><p>Closure for vmapped evaluation.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.get_ensemble_model">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.neuralil_evaluation.</span></span><span class="sig-name descname"><span class="pre">get_ensemble_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">individual_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ensemble</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_class</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/neuralil_evaluation.html#get_ensemble_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.get_ensemble_model" title="Permalink to this definition"></a></dt>
<dd><p>Function to load a NeuralIL cheap ensemble for evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>individual_model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralIL</span></code>) – Trained NeuralIL model.</p></li>
<li><p><strong>n_ensemble</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of members in the ensemble.</p></li>
<li><p><strong>ensemble_class</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>) – Type of neuralil.ensemble_model</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>NeuralIL cheap ensemble.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.neuralil_evaluation.load_neuralil_model">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.neuralil_evaluation.</span></span><span class="sig-name descname"><span class="pre">load_neuralil_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pickled_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_class=&lt;class</span> <span class="pre">'neuralil.model.NeuralIL'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">**kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/neuralil_evaluation.html#load_neuralil_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.neuralil_evaluation.load_neuralil_model" title="Permalink to this definition"></a></dt>
<dd><p>Load a NeuralIL model for evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pickled_model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Filename and full path to model.</p></li>
<li><p><strong>max_neighbors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Maximum number of neighbors to be taken into account
for descriptor generation.</p></li>
<li><p><strong>core_class</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>) – Type of the neuralil.model core.</p></li>
<li><p><strong>model_class</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code>) – Type of the neuralil.model model.</p></li>
<li><p><strong>kwargs</strong> – These parameters are passed to PowerSpectrumGenerator().</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NeuralIL</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple containing</p>
<blockquote>
<div><ul class="simple">
<li><p>Individual NeuralIL model.</p></li>
<li><p>Model info.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-clinamen2.utils.plot_functions">
<span id="clinamen2-utils-plot-functions-module"></span><h2>clinamen2.utils.plot_functions module<a class="headerlink" href="#module-clinamen2.utils.plot_functions" title="Permalink to this heading"></a></h2>
<p>Plot functions for CMA-ES results.</p>
<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.plot_functions.</span></span><span class="sig-name descname"><span class="pre">CMAPlotHelper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generation_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'dark_area':</span> <span class="pre">'#3e4989',</span> <span class="pre">'dark_line':</span> <span class="pre">'#440154',</span> <span class="pre">'highlight':</span> <span class="pre">'#fde725',</span> <span class="pre">'light_area':</span> <span class="pre">'#b5de2b',</span> <span class="pre">'light_line':</span> <span class="pre">'#6ece58',</span> <span class="pre">'medium_area':</span> <span class="pre">'#1f9e89',</span> <span class="pre">'medium_line':</span> <span class="pre">'#31688e'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ax_label':</span> <span class="pre">28,</span> <span class="pre">'legend':</span> <span class="pre">24,</span> <span class="pre">'tick_param':</span> <span class="pre">24,</span> <span class="pre">'title':</span> <span class="pre">36}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Setup figure parameters and plot common results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Label identifying the evolution and its results.</p></li>
<li><p><strong>input_dir</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – Directory to read data from.</p></li>
<li><p><strong>handler</strong> – Object to access the stored evolution and generations.</p></li>
<li><p><strong>generation_bounds</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – First and last generation to include. Count starts
at 1, because generation 0 is the founder.
If generation_bounds[1] is passed in with value -1, the last
generation is read from the evolution element “last_gen” if
present.</p></li>
<li><p><strong>losses</strong> – Loss of all read individuals.</p></li>
<li><p><strong>generations</strong> – Indices of all read generations.</p></li>
<li><p><strong>step_sizes</strong> – Step size of AlgorithmState.</p></li>
<li><p><strong>output_dir</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]) – Directory to save files to. Will be created if it does not
exist. Default is None.</p></li>
<li><p><strong>information_list</strong> – List of dictionaries with additional information per
generation.</p></li>
<li><p><strong>additional_info_types</strong> – Contains keys identifying additional information
and the corresponding types as values for all additional
information that is of type numpy.ndarray, list of Numbers or
Number.</p></li>
<li><p><strong>figsize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Default figure size to be used when no alternative is passed
to a plotting function.</p></li>
<li><p><strong>colors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Dictionary of colors to be used in the plots.</p></li>
<li><p><strong>fontsizes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>) – Dictionary of fontsizes to be used in the plots.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper.classify_additional_information">
<span class="sig-name descname"><span class="pre">classify_additional_information</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper.classify_additional_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper.classify_additional_information" title="Permalink to this definition"></a></dt>
<dd><p>Parse additional information and classify.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper.get_data_from_generations">
<span class="sig-name descname"><span class="pre">get_data_from_generations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper.get_data_from_generations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper.get_data_from_generations" title="Permalink to this definition"></a></dt>
<dd><p>Parse generations with handler and return data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper.plot_additional_information_per_generation">
<span class="sig-name descname"><span class="pre">plot_additional_information_per_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generation_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper.plot_additional_information_per_generation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper.plot_additional_information_per_generation" title="Permalink to this definition"></a></dt>
<dd><p>Plot additional information depending on its type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Key that identifies the additional information. Supercedes
index if both given. Default is None.</p></li>
<li><p><strong>ax</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Axis</span></code>]) – Main ax of figure. To be twinned if present. Default is None.</p></li>
<li><p><strong>generation_bounds</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – First and last generation to include. Count
starts at 1, because generation 0 is the founder.</p></li>
<li><p><strong>figsize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Default figure size to be used when no alternative is
passed to a plotting function.</p></li>
<li><p><strong>y_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Units of loss to be added to y_label. Default is empty
string.</p></li>
<li><p><strong>save_fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True the figure will be saved to file. Default is
False.</p></li>
<li><p><strong>fig_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File type to be saved. Default is ‘pdf’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Label for plot legend.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper.plot_additional_per_individual">
<span class="sig-name descname"><span class="pre">plot_additional_per_individual</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generation_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper.plot_additional_per_individual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper.plot_additional_per_individual" title="Permalink to this definition"></a></dt>
<dd><p>Plot additional info per individual per generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Key that identifies the additional information.
Supercedes index if both given. Default is None.</p></li>
<li><p><strong>generations</strong> – Number of generations to be included.</p></li>
<li><p><strong>generation_bounds</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – First and last generation to include. Count
starts at 1, because generation 0 is the founder.</p></li>
<li><p><strong>figsize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Default figure size to be used when no alternative is
passed to a plotting function.</p></li>
<li><p><strong>show_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, plot a legend. Default is True.</p></li>
<li><p><strong>ref_val</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Value to be plotted as a reference line. Default is None.</p></li>
<li><p><strong>y_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Units of loss to be added to y_label. Default is empty
string.</p></li>
<li><p><strong>save_fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True the figure will be saved to file. Default  is
False.</p></li>
<li><p><strong>fig_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File type to be saved. Default is ‘pdf’.</p></li>
<li><p><strong>kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]) – Dicitionary with additional keywords.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper.plot_loss_boxplots">
<span class="sig-name descname"><span class="pre">plot_loss_boxplots</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_by_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper.plot_loss_boxplots"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper.plot_loss_boxplots" title="Permalink to this definition"></a></dt>
<dd><p>Plot loss of gen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>generations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>) – Index of generations to be plotted. More than five will
not produce a satisfactory result.</p></li>
<li><p><strong>figsize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Default figure size to be used when no alternative is
passed to a plotting function.</p></li>
<li><p><strong>y_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Units of loss to be added to y_label. Default is empty
string.</p></li>
<li><p><strong>color_key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – If True, the scatter plot will be colored according
to the data in ‘key’. Default is False.</p></li>
<li><p><strong>save_fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True the figure will be saved to file. Default is
False.</p></li>
<li><p><strong>fig_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File type to be saved. Default is ‘pdf’.</p></li>
<li><p><strong>color_by_key</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper.plot_loss_per_generation">
<span class="sig-name descname"><span class="pre">plot_loss_per_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generation_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper.plot_loss_per_generation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper.plot_loss_per_generation" title="Permalink to this definition"></a></dt>
<dd><p>Plot loss per individual per generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>generations</strong> – Number of generations to be included.</p></li>
<li><p><strong>generation_bounds</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – First and last generation to include. Count
starts at 1, because generation 0 is the founder.</p></li>
<li><p><strong>figsize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Default figure size to be used when no alternative is
passed to a plotting function.</p></li>
<li><p><strong>show_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, plot a legend. Default is True.</p></li>
<li><p><strong>ref_val</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Value to be plotted as a reference line. Default is None.</p></li>
<li><p><strong>y_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Units of loss to be added to y_label. Default is empty
string.</p></li>
<li><p><strong>y_lim</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Limit to restrict y axis. Default is None.</p></li>
<li><p><strong>save_fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True the figure will be saved to file. Default is
False.</p></li>
<li><p><strong>fig_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File type to be saved. Default is ‘pdf’.</p></li>
<li><p><strong>kwargs</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code>]) – Dicitionary with additional keywords.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper.plot_loss_with_errorbars">
<span class="sig-name descname"><span class="pre">plot_loss_with_errorbars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errorbars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper.plot_loss_with_errorbars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper.plot_loss_with_errorbars" title="Permalink to this definition"></a></dt>
<dd><p>Plot loss of gen.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>generation</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Index of generation.</p></li>
<li><p><strong>key</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Identifies the additional information to be plotted.</p></li>
<li><p><strong>figsize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Default figure size to be used when no alternative is
passed to a plotting function.</p></li>
<li><p><strong>errorbars</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, errorbars are plotted.</p></li>
<li><p><strong>y_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Units of loss to be added to y_label.Default is empty
string.</p></li>
<li><p><strong>save_fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True the figure will be saved to file. Default is
False.</p></li>
<li><p><strong>fig_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File type to be saved. Default is ‘pdf’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper.plot_mean_loss_per_generation">
<span class="sig-name descname"><span class="pre">plot_mean_loss_per_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">generation_bounds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_sigma_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_e_mult</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_min_e</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_lim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_fig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pdf'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper.plot_mean_loss_per_generation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper.plot_mean_loss_per_generation" title="Permalink to this definition"></a></dt>
<dd><p>Plot mean loss per generation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>generations</strong> – Number of generations to be included.</p></li>
<li><p><strong>generation_bounds</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]]) – First and last generation to include. Count
starts at 1, because generation 0 is the founder.</p></li>
<li><p><strong>figsize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Default figure size to be used when no alternative is
passed to a plotting function.</p></li>
<li><p><strong>show_sigma_e</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, sigma_e_mult * std deviation is plotted
additionally around the mean. Default is True.</p></li>
<li><p><strong>sigma_e_mult</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – If sigma_e is shown, this defines the width.</p></li>
<li><p><strong>show_min_e</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, the minimum loss within each generation will
be plotted. Default is False.</p></li>
<li><p><strong>show_sigma</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, plot step size on axis y2. Default is False.</p></li>
<li><p><strong>show_legend</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, plot a legend. Default is True.</p></li>
<li><p><strong>y_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Units of loss to be added to y_label. Default is empty
string.</p></li>
<li><p><strong>y_lim</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Tuple of y_min and y_max to restrict the plot.
Default is None.</p></li>
<li><p><strong>ref_val</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Value to be plotted as a reference line. Default is None.</p></li>
<li><p><strong>save_fig</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True the figure will be saved to file. Default is
False.</p></li>
<li><p><strong>fig_type</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – File type to be saved. Default is ‘pdf’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="clinamen2.utils.plot_functions.CMAPlotHelper.plot_stepsize_ax2">
<span class="sig-name descname"><span class="pre">plot_stepsize_ax2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected_generations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/plot_functions.html#CMAPlotHelper.plot_stepsize_ax2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.plot_functions.CMAPlotHelper.plot_stepsize_ax2" title="Permalink to this definition"></a></dt>
<dd><p>Plot stepsize as twin of given axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Axis</span></code>) – Main ax of figure. To be twinned.</p></li>
<li><p><strong>x</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>) – Values for x-axis.</p></li>
<li><p><strong>selected_generations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>) – Generations to be plotted.</p></li>
<li><p><strong>y_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Units of loss to be added to y_label.
Default is r’ / si{ngstrom}’.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Axis</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-clinamen2.utils.script_functions">
<span id="clinamen2-utils-script-functions-module"></span><h2>clinamen2.utils.script_functions module<a class="headerlink" href="#module-clinamen2.utils.script_functions" title="Permalink to this heading"></a></h2>
<p>Reusable code for Python script calls.</p>
<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.script_functions.cma_parser">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.script_functions.</span></span><span class="sig-name descname"><span class="pre">cma_parser</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/script_functions.html#cma_parser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.script_functions.cma_parser" title="Permalink to this definition"></a></dt>
<dd><p>Argument parser for example scripts.</p>
<p>Has the CMA-ES parameters as attributes.</p>
<p>Further arguments added to this base parser
may not have a shortcut.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgumentParser</span></code></p>
</dd>
</dl>
<dl class="simple">
<dt>Returns</dt><dd><p>parser</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.script_functions.cma_setup">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.script_functions.</span></span><span class="sig-name descname"><span class="pre">cma_setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pop_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_cholesky_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/script_functions.html#cma_setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.script_functions.cma_setup" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to initialize the algorithm</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.params_and_state.AlgorithmParameters" title="clinamen2.cmaes.params_and_state.AlgorithmParameters"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmParameters</span></code></a>, <a class="reference internal" href="clinamen2.cmaes.html#clinamen2.cmaes.params_and_state.AlgorithmState" title="clinamen2.cmaes.params_and_state.AlgorithmState"><code class="xref py py-class docutils literal notranslate"><span class="pre">AlgorithmState</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.script_functions.generate_result_figures">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.script_functions.</span></span><span class="sig-name descname"><span class="pre">generate_result_figures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generation_bounds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">8)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">json</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/script_functions.html#generate_result_figures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.script_functions.generate_result_figures" title="Permalink to this definition"></a></dt>
<dd><p>Create two default figures for given evolution.</p>
<ul class="simple">
<li><p>CMA_PlotHandler.plot_mean_loss_per_generation()</p></li>
<li><p>CMA_PlotHandler.plot_loss_per_generation()</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Label of the evolution run.</p></li>
<li><p><strong>input_dir</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – Full path to the generated data.</p></li>
<li><p><strong>generation_bounds</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>]) – Plot data between these generations.</p></li>
<li><p><strong>output_dir</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>]) – Full path to save figures to. DEfaults to input_dir.</p></li>
<li><p><strong>figsize</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Matpplotlib figure size. Default is (10, 8).</p></li>
<li><p><strong>y_units</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – Units of loss. Default is empty string.</p></li>
<li><p><strong>json</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – Data is stored in JSON files.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-clinamen2.utils.structure_setup">
<span id="clinamen2-utils-structure-setup-module"></span><h2>clinamen2.utils.structure_setup module<a class="headerlink" href="#module-clinamen2.utils.structure_setup" title="Permalink to this heading"></a></h2>
<p>Reusable code for ASE structure setup and ASE related functions.</p>
<p>Meant to offer simple versions of reusable functions and
a possible starting point / template for more complex applications.</p>
<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.AnchorToImmutable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">AnchorToImmutable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">immutable_atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#AnchorToImmutable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.AnchorToImmutable" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that appends immutable atoms to an atoms object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>immutable_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code>) – Atoms that always have to be added to complete the
transformation of a CMA-ES sample to an atoms object to perform
calculations on.</p></li>
<li><p><strong>sort_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – If True, ase.build.sort() will be applied to the resulting
atoms object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.DofPipeline">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">DofPipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">anchor_to_immutable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof_to_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">apply_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#DofPipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.DofPipeline" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Functions to be applied to CMA samples in reverse order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>anchor_to_immutable</strong> (<em>Callable</em>) – Combine dof atoms with immutable atoms.
Default is None, None function will be skipped.</p></li>
<li><p><strong>dof_to_atoms</strong> (<em>Callable</em>) – Construct an atoms object from a CMA-ES sample.
Default is None, None function will be skipped.</p></li>
<li><p><strong>apply_weights</strong> (<em>Callable</em>) – Dampen or amplify variation of variables in CMA degrees
of freedem vector. Default is None, None function will be skipped.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.DofPipeline.anchor_to_immutable">
<span class="sig-name descname"><span class="pre">anchor_to_immutable</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#clinamen2.utils.structure_setup.DofPipeline.anchor_to_immutable" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.DofPipeline.apply_weights">
<span class="sig-name descname"><span class="pre">apply_weights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#clinamen2.utils.structure_setup.DofPipeline.apply_weights" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.DofPipeline.dof_to_atoms">
<span class="sig-name descname"><span class="pre">dof_to_atoms</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#clinamen2.utils.structure_setup.DofPipeline.dof_to_atoms" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.DofToAtoms">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">DofToAtoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">template_atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#DofToAtoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.DofToAtoms" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that creates an atoms object from a compatible CMA-ES sample.</p>
<p>The degrees of freedom making up the sample are translated into the
positions of atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>template_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code>) – Template of an atoms object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.FilterEvalWorkflow">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">FilterEvalWorkflow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#FilterEvalWorkflow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.FilterEvalWorkflow" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>Evaluation and filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter</strong> (<em>Callable</em>) – Function that filters (marks) results to be omitted.</p></li>
<li><p><strong>evaluate_loss</strong> (<em>Callable</em>) – Function that calculates the loss from input.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.FilterEvalWorkflow.evaluate_loss">
<span class="sig-name descname"><span class="pre">evaluate_loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#clinamen2.utils.structure_setup.FilterEvalWorkflow.evaluate_loss" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.FilterEvalWorkflow.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></em><a class="headerlink" href="#clinamen2.utils.structure_setup.FilterEvalWorkflow.filter" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.bias_covariance_matrix_gauss">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">bias_covariance_matrix_gauss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled_position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#bias_covariance_matrix_gauss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.bias_covariance_matrix_gauss" title="Permalink to this definition"></a></dt>
<dd><p>Return Cholesky factor of biased covariance matrix.</p>
<p>Use Gaussian for decay.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code>) – Input structure.</p></li>
<li><p><strong>scaled_positions</strong> – Positions to compare to (in [0, 1]).</p></li>
<li><p><strong>c_r</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Overall bias weight parameter.</p></li>
<li><p><strong>sigma_cov</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Gaussian weight parameter.</p></li>
<li><p><strong>dimension</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Dimension of the input problem.</p></li>
<li><p><strong>scaled_position</strong> (<em>_SupportsArray</em><em>[</em><em>dtype</em><em>] </em><em>| </em><em>_NestedSequence</em><em>[</em><em>_SupportsArray</em><em>[</em><em>dtype</em><em>]</em><em>] </em><em>| </em><em>bool</em><em> | </em><em>int</em><em> | </em><em>float</em><em> | </em><em>complex</em><em> | </em><em>str</em><em> | </em><em>bytes</em><em> | </em><em>_NestedSequence</em><em>[</em><em>bool</em><em> | </em><em>int</em><em> | </em><em>float</em><em> | </em><em>complex</em><em> | </em><em>str</em><em> | </em><em>bytes</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.bias_covariance_matrix_r">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">bias_covariance_matrix_r</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled_position</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimension</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#bias_covariance_matrix_r"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.bias_covariance_matrix_r" title="Permalink to this definition"></a></dt>
<dd><p>Return Cholesky factor of biased covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code>) – Input structure.</p></li>
<li><p><strong>scaled_positions</strong> – Positions to compare to (in [0, 1]).</p></li>
<li><p><strong>c_r</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Overall bias weight parameter.</p></li>
<li><p><strong>dimension</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Dimension of the input problem.</p></li>
<li><p><strong>scaled_position</strong> (<em>_SupportsArray</em><em>[</em><em>dtype</em><em>] </em><em>| </em><em>_NestedSequence</em><em>[</em><em>_SupportsArray</em><em>[</em><em>dtype</em><em>]</em><em>] </em><em>| </em><em>bool</em><em> | </em><em>int</em><em> | </em><em>float</em><em> | </em><em>complex</em><em> | </em><em>str</em><em> | </em><em>bytes</em><em> | </em><em>_NestedSequence</em><em>[</em><em>bool</em><em> | </em><em>int</em><em> | </em><em>float</em><em> | </em><em>complex</em><em> | </em><em>str</em><em> | </em><em>bytes</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code></p>
</dd>
</dl>
<dl class="simple">
<dt>Ref:</dt><dd><p>[1] M. Arrigoni et al., npj Comput. Mater., 2021, 7, 1-13.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.create_apply_weights">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">create_apply_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#create_apply_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.create_apply_weights" title="Permalink to this definition"></a></dt>
<dd><p>Closure to create the apply_weights() function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code>) – Vector of floats to be applied to a CMA-ES sample by
multiplication.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Function that applies the given weights to a numpy array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.create_filter_eval_workflow">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">create_filter_eval_workflow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">workflow</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#create_filter_eval_workflow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.create_filter_eval_workflow" title="Permalink to this definition"></a></dt>
<dd><p>Create evaluation workflow with uncertainty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>workflow</strong> (<a class="reference internal" href="#clinamen2.utils.structure_setup.FilterEvalWorkflow" title="clinamen2.utils.structure_setup.FilterEvalWorkflow"><code class="xref py py-class docutils literal notranslate"><span class="pre">FilterEvalWorkflow</span></code></a>) – Workflow to create closure from.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.create_split_atom">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">create_split_atom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sorted_elements</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#create_split_atom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.create_split_atom" title="Permalink to this definition"></a></dt>
<dd><p>Translate ase.atoms.Atoms object to NeuralIL input.</p>
<p>That is, positions, types and cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sorted_elements</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>) – Input for symbol_map setup.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.create_transform_dof">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">create_transform_dof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#create_transform_dof"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.create_transform_dof" title="Permalink to this definition"></a></dt>
<dd><p>Closure to create a composite function from DofPipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pipeline</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NamedTuple</span></code>) – Named tuple containing the functions to be applied in
reverse order.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.get_distances_from_position">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">get_distances_from_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#get_distances_from_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.get_distances_from_position" title="Permalink to this definition"></a></dt>
<dd><p>Get distances to position in Angstrom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code>) – Atoms object to calculate distances for.</p></li>
<li><p><strong>position</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Position to calculate distance from.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.get_distances_from_scaled_position">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">get_distances_from_scaled_position</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled_position</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#get_distances_from_scaled_position"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.get_distances_from_scaled_position" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for get_distances_from_position().</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Atoms</span></code>) – Atoms object to calculate distances for.</p></li>
<li><p><strong>scaled_position</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Position to calculate distance from.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.place_atoms_packmol">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">place_atoms_packmol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">38</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exec_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#place_atoms_packmol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.place_atoms_packmol" title="Permalink to this definition"></a></dt>
<dd><p>Place atoms within a volume utilizing packmol.</p>
<p>Packmol is started as subprocess with limited error handling. For a
detailed description see packmol documentation.
Input file is created from a jinja2 template.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of atoms to be placed.</p></li>
<li><p><strong>side_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Atoms are placed within a cube of this side length.</p></li>
<li><p><strong>tolerance</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Packmol parameter tolerance (interatomic distance).</p></li>
<li><p><strong>exec_string</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]) – Packmol executable with full path.</p></li>
<li><p><strong>random_seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Seed for packmol input. Default is -1, which leads to
packmol generating a random seed.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>[1]: L. Martínez, R. Andrade, E. G. Birgin, J. M. Martínez.
J. Comput. Chem., 30(13):2157-2164, 2009.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.place_atoms_random_cube">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">place_atoms_random_cube</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">38</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">side_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#place_atoms_random_cube"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.place_atoms_random_cube" title="Permalink to this definition"></a></dt>
<dd><p>Place atoms randomly within a cube of a given size.</p>
<p>The cube is always centered on zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of atoms to be placed.</p></li>
<li><p><strong>side_length</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Side length of the cube.</p></li>
<li><p><strong>random_seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Seed for the random number generator. Default is 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.place_atoms_random_sphere">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">place_atoms_random_sphere</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">38</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#place_atoms_random_sphere"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.place_atoms_random_sphere" title="Permalink to this definition"></a></dt>
<dd><p>Place atoms randomly within a sphere of a given radius.</p>
<p>The sphere is always centered at zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_atoms</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Number of atoms to be placed.</p></li>
<li><p><strong>radius</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>) – Radius of the sphere.</p></li>
<li><p><strong>random_seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>) – Seed for the random number generator. Default is 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="clinamen2.utils.structure_setup.prepare_dof_and_pipeline">
<span class="sig-prename descclassname"><span class="pre">clinamen2.utils.structure_setup.</span></span><span class="sig-name descname"><span class="pre">prepare_dof_and_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">founder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/clinamen2/utils/structure_setup.html#prepare_dof_and_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#clinamen2.utils.structure_setup.prepare_dof_and_pipeline" title="Permalink to this definition"></a></dt>
<dd><p>Get dof vector and pipeline for reconstruction.</p>
<p>The atoms that are accessible by the algorithm can be defined by a sphere.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>founder</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code>) – Full path to founder POSCAR.</p></li>
<li><p><strong>scaled_center</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]) – Center point of dof sphere, in scaled coordinates.</p></li>
<li><p><strong>radius</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]) – Radius of dof sphere.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.typing.ArrayLike</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-clinamen2.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-clinamen2.utils" title="Permalink to this heading"></a></h2>
<p>Copyright 2023 The Clinamen2 contributors</p>
<p>Licensed under the Apache License, Version 2.0 (the “License”);
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>
<blockquote>
<div><p><a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>
</div></blockquote>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="clinamen2.runner.html" class="btn btn-neutral float-left" title="clinamen2.runner package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Clinamen2 contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>